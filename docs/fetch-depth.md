# `fetch-depth` とは

Git の **履歴をどこまで取得するか（浅い clone）** の設定です。

| 値    | 動作             |
| ---- | -------------- |
| `1`  | 最新コミットだけ取得（最速） |
| `0`  | 全履歴取得（完全clone） |
| `10` | 直近10コミット       |

---

## `fetch-depth: 1` の状態

```
A -- B -- C -- D (HEAD)
           ↑
      これだけ取る
```

👉 CIが高速になる（かなり重要）

---

# デフォルト値

実はデフォルトも **1** です
（だから明示的に書くのは意図表明に近い）

---

# ただし注意（超重要）

履歴がないので次が壊れます

| やりたいこと             | 結果           |
| ------------------ | ------------ |
| `git diff`         | 前のコミットが無くて失敗 |
| `git describe`     | タグ取れない       |
| changelog生成        | 不可能          |
| Lerna / Changesets | 壊れる          |
| monorepoの差分検知      | 壊れる          |

---

# そういう時

```yaml
with:
  fetch-depth: 0
```

完全cloneにする必要があります。

---

# よくある実務パターン

## テストだけ

```yaml
fetch-depth: 1   # 高速
```

## バージョン計算 / 差分デプロイ

```yaml
fetch-depth: 0   # 必須
```
